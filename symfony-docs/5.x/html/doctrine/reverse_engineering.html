

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to Generate Entities from an Existing Database &mdash; Symfony Framework Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/rtd_custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Store Sessions in a Database" href="../session/database.html" />
    <link rel="prev" title="How to Define Relationships with Abstract Classes and Interfaces" href="resolve_target_entity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #f0f0f0" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/symfony-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.x}
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_tour/index.html">The Quick Tour</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../best_practices.html">The Symfony Framework Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundles.html">The Bundle System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console.html">Console Commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../doctrine.html">Databases and the Doctrine ORM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#installing-doctrine">Installing Doctrine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#creating-an-entity-class">Creating an Entity Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#migrations-creating-the-database-tables-schema">Migrations: Creating the Database Tables/Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#migrations-adding-more-fields">Migrations &amp; Adding more Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#persisting-objects-to-the-database">Persisting Objects to the Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#validating-objects">Validating Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#fetching-objects-from-the-database">Fetching Objects from the Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#automatically-fetching-objects-paramconverter">Automatically Fetching Objects (ParamConverter)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#updating-an-object">Updating an Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#deleting-an-object">Deleting an Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#querying-for-objects-the-repository">Querying for Objects: The Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#relationships-and-associations">Relationships and Associations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#database-testing">Database Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doctrine.html#doctrine-extensions-timestampable-translatable-etc">Doctrine Extensions (Timestampable, Translatable, etc.)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../doctrine.html#learn-more">Learn more</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="associations.html">How to Work with Doctrine Associations / Relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="events.html">Doctrine Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="registration_form.html">How to Implement a Registration Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_dql_functions.html">How to Register custom DQL Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="dbal.html">How to Use Doctrine DBAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiple_entity_managers.html">How to Work with multiple Entity Managers and Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="resolve_target_entity.html">How to Define Relationships with Abstract Classes and Interfaces</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How to Generate Entities from an Existing Database</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-the-getters-setters-or-php-classes">Generating the Getters &amp; Setters or PHP Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../session/database.html">Store Sessions in a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../testing/database.html">How to Test Code that Interacts with the Database</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">How to Deploy a Symfony Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../email.html">Swift Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_dispatcher.html">Events and Event Listeners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../forms.html">Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontend.html">Managing CSS and JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_cache.html">HTTP Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_client.html">HTTP Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lock.html">Dealing with Concurrency with Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mailer.html">Sending Emails with Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mercure.html">Pushing Data to Clients Using the Mercure Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../messenger.html">Messenger: Sync &amp; Queued Message Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating an Existing Application to Symfony</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notifier.html">Creating and Sending Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiler.html">Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rate_limiter.html">Rate Limiter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serializer.html">How to Use the Serializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_container.html">Service Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../translation.html">Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validation.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_link.html">Asset Preloading and Resource Hints with HTTP/2 and WebLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components/index.html">The Components</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Documents</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../create_framework/index.html">Create your own PHP Framework</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Symfony Framework Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../doctrine.html">Databases and the Doctrine ORM</a> &raquo;</li>
        
      <li>How to Generate Entities from an Existing Database</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/doctrine/reverse_engineering.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-generate-entities-from-an-existing-database">
<span id="index-0"></span><h1>How to Generate Entities from an Existing Database<a class="headerlink" href="#how-to-generate-entities-from-an-existing-database" title="Permalink to this headline">¶</a></h1>
<p>When starting work on a brand new project that uses a database, two different
situations comes naturally. In most cases, the database model is designed
and built from scratch. Sometimes, however, you’ll start with an existing and
probably unchangeable database model. Fortunately, Doctrine comes with a bunch
of tools to help generate model classes from your existing database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As the <a class="reference external" href="https://www.doctrine-project.org/projects/doctrine-orm/en/current/reference/tools.html#reverse-engineering">Doctrine tools documentation</a> says, reverse engineering is a
one-time process to get started on a project. Doctrine is able to convert
approximately 70-80% of the necessary mapping information based on fields,
indexes and foreign key constraints. Doctrine can’t discover inverse
associations, inheritance types, entities with foreign keys as primary keys
or semantical operations on associations such as cascade or lifecycle
events. Some additional work on the generated entities will be necessary
afterwards to design each to fit your domain model specificities.</p>
</div>
<p>This tutorial assumes you’re using a simple blog application with the following
two tables: <code class="docutils literal notranslate"><span class="pre">blog_post</span></code> and <code class="docutils literal notranslate"><span class="pre">blog_comment</span></code>. A comment record is linked
to a post record thanks to a foreign key constraint.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">blog_post</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="o">`</span><span class="n">title</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">content</span><span class="o">`</span> <span class="n">longtext</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">created_at</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">1</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span> <span class="k">COLLATE</span><span class="o">=</span><span class="n">utf8_unicode_ci</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">blog_comment</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="o">`</span><span class="n">post_id</span><span class="o">`</span> <span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">author</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">content</span><span class="o">`</span> <span class="n">longtext</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">created_at</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span>
  <span class="k">KEY</span> <span class="o">`</span><span class="n">blog_comment_post_id_idx</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">post_id</span><span class="o">`</span><span class="p">),</span>
  <span class="k">CONSTRAINT</span> <span class="o">`</span><span class="n">blog_post_id</span><span class="o">`</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">post_id</span><span class="o">`</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="o">`</span><span class="n">blog_post</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span> <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">1</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span> <span class="k">COLLATE</span><span class="o">=</span><span class="n">utf8_unicode_ci</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Before diving into the recipe, be sure your database connection parameters are
correctly setup in the <code class="docutils literal notranslate"><span class="pre">.env</span></code> file (or <code class="docutils literal notranslate"><span class="pre">.env.local</span></code> override file).</p>
<p>The first step towards building entity classes from an existing database
is to ask Doctrine to introspect the database and generate the corresponding
metadata files. Metadata files describe the entity class to generate based on
table fields.</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console doctrine:mapping:import <span class="s2">&quot;App\Entity&quot;</span> annotation --path<span class="o">=</span>src/Entity
</pre></div>
</td></tr></table></div>
<p>This command line tool asks Doctrine to introspect the database and generate
new PHP classes with annotation metadata into <code class="docutils literal notranslate"><span class="pre">src/Entity</span></code>. This generates two
files: <code class="docutils literal notranslate"><span class="pre">BlogPost.php</span></code> and <code class="docutils literal notranslate"><span class="pre">BlogComment.php</span></code>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>It’s also possible to generate the metadata files into XML or eventually into YAML:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console doctrine:mapping:import <span class="s2">&quot;App\Entity&quot;</span> xml --path<span class="o">=</span>config/doctrine
</pre></div>
</td></tr></table></div>
<p>In this case, make sure to adapt your mapping configuration accordingly:</p>
<div class="last highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/doctrine.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">doctrine</span><span class="p p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l l-Scalar l-Scalar-Plain">orm</span><span class="p p-Indicator">:</span>
        <span class="c1"># ...</span>
        <span class="l l-Scalar l-Scalar-Plain">mappings</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">App</span><span class="p p-Indicator">:</span>
                <span class="l l-Scalar l-Scalar-Plain">is_bundle</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
                <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">xml</span> <span class="c1"># &quot;yml&quot; is marked as deprecated for doctrine v2.6+ and will be removed in v3</span>
                <span class="l l-Scalar l-Scalar-Plain">dir</span><span class="p p-Indicator">:</span> <span class="s">&#39;%kernel.project_dir%/config/doctrine&#39;</span>
                <span class="l l-Scalar l-Scalar-Plain">prefix</span><span class="p p-Indicator">:</span> <span class="s">&#39;App\Entity&#39;</span>
                <span class="l l-Scalar l-Scalar-Plain">alias</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">App</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="generating-the-getters-setters-or-php-classes">
<h2>Generating the Getters &amp; Setters or PHP Classes<a class="headerlink" href="#generating-the-getters-setters-or-php-classes" title="Permalink to this headline">¶</a></h2>
<p>The generated PHP classes now have properties and annotation metadata, but they
do <em>not</em> have any getter or setter methods. If you generated XML or YAML metadata,
you don’t even have the PHP classes!</p>
<p>To generate the missing getter/setter methods (or to <em>create</em> the classes if necessary),
run:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="go">// generates getter/setter methods</span>
<span class="gp">$</span> php bin/console make:entity --regenerate App
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to have a OneToMany relationship, you will need to add
it manually into the entity (e.g. add a <code class="docutils literal notranslate"><span class="pre">comments</span></code> property to <code class="docutils literal notranslate"><span class="pre">BlogPost</span></code>)
or to the generated XML or YAML files. Add a section on the specific entities
for one-to-many defining the <code class="docutils literal notranslate"><span class="pre">inversedBy</span></code> and the <code class="docutils literal notranslate"><span class="pre">mappedBy</span></code> pieces.</p>
</div>
<p>The generated entities are now ready to be used. Have fun!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2004-2020 Fabien Potencier

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>