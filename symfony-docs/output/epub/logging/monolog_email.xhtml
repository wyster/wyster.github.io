<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>How to Configure Monolog to Email Errors</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd_custom.css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-configure-monolog-to-email-errors">
<span id="index-0"></span><h1>How to Configure Monolog to Email Errors</h1>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This feature is compatible with the new <a class="reference internal" href="../mailer.xhtml"><span class="doc">Symfony mailer</span></a>
starting from Symfony 5.1. All previous versions require using SwiftMailer.</p>
</div>
<p><a class="reference external" href="https://github.com/Seldaek/monolog">Monolog</a><span class="link-target"> [https://github.com/Seldaek/monolog]</span> can be configured to send an email when an error occurs within an
application. The configuration for this requires a few nested handlers
in order to avoid receiving too many emails. This configuration looks
complicated at first but each handler is fairly straightforward when
it is broken down.</p>
<div class="configuration-block">
<ul class="simple">
<li><p><em>YAML</em><div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/prod/monolog.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">monolog</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">handlers</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">main</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>         <span class="l l-Scalar l-Scalar-Plain">fingers_crossed</span>
            <span class="c1"># 500 errors are logged at the critical level</span>
            <span class="l l-Scalar l-Scalar-Plain">action_level</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">critical</span>
            <span class="c1"># to also log 400 level errors (but not 404&#39;s):</span>
            <span class="c1"># action_level: error</span>
            <span class="c1"># excluded_404s:</span>
            <span class="c1">#     - ^/</span>
            <span class="l l-Scalar l-Scalar-Plain">handler</span><span class="p p-Indicator">:</span>      <span class="l l-Scalar l-Scalar-Plain">deduplicated</span>
        <span class="l l-Scalar l-Scalar-Plain">deduplicated</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>    <span class="l l-Scalar l-Scalar-Plain">deduplication</span>
            <span class="l l-Scalar l-Scalar-Plain">handler</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">swift</span>
        <span class="l l-Scalar l-Scalar-Plain">swift</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>       <span class="l l-Scalar l-Scalar-Plain">swift_mailer</span>
            <span class="l l-Scalar l-Scalar-Plain">from_email</span><span class="p p-Indicator">:</span> <span class="s">&#39;error@example.com&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">to_email</span><span class="p p-Indicator">:</span>   <span class="s">&#39;error@example.com&#39;</span>
            <span class="c1"># or list of recipients</span>
            <span class="c1"># to_email:   [&#39;dev1@example.com&#39;, &#39;dev2@example.com&#39;, ...]</span>
            <span class="l l-Scalar l-Scalar-Plain">subject</span><span class="p p-Indicator">:</span>    <span class="s">&#39;An</span><span class="nv"> </span><span class="s">Error</span><span class="nv"> </span><span class="s">Occurred!</span><span class="nv"> </span><span class="s">%%message%%&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">level</span><span class="p p-Indicator">:</span>      <span class="l l-Scalar l-Scalar-Plain">debug</span>
            <span class="l l-Scalar l-Scalar-Plain">formatter</span><span class="p p-Indicator">:</span>  <span class="l l-Scalar l-Scalar-Plain">monolog.formatter.html</span>
            <span class="l l-Scalar l-Scalar-Plain">content_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">text/html</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>XML</em><div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/packages/prod/monolog.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:monolog=</span><span class="s">&quot;http://symfony.com/schema/dic/monolog&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        https://symfony.com/schema/dic/services/services-1.0.xsd</span>
<span class="s">        http://symfony.com/schema/dic/monolog https://symfony.com/schema/dic/monolog/monolog-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;monolog:config&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">        500 errors are logged at the critical level,</span>
<span class="c">        to also log 400 level errors (but not 404&#39;s):</span>
<span class="c">        action-level=&quot;error&quot;</span>
<span class="c">        And add this child inside this monolog:handler</span>
<span class="c">        &lt;monolog:excluded-404&gt;^/&lt;/monolog:excluded-404&gt;</span>
<span class="c">        --&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;main&quot;</span>
            <span class="na">type=</span><span class="s">&quot;fingers_crossed&quot;</span>
            <span class="na">action-level=</span><span class="s">&quot;critical&quot;</span>
            <span class="na">handler=</span><span class="s">&quot;deduplicated&quot;</span>
        <span class="nt">/&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;deduplicated&quot;</span>
            <span class="na">type=</span><span class="s">&quot;deduplication&quot;</span>
            <span class="na">handler=</span><span class="s">&quot;swift&quot;</span>
        <span class="nt">/&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;swift&quot;</span>
            <span class="na">type=</span><span class="s">&quot;swift_mailer&quot;</span>
            <span class="na">from-email=</span><span class="s">&quot;error@example.com&quot;</span>
            <span class="na">subject=</span><span class="s">&quot;An Error Occurred! %%message%%&quot;</span>
            <span class="na">level=</span><span class="s">&quot;debug&quot;</span>
            <span class="na">formatter=</span><span class="s">&quot;monolog.formatter.html&quot;</span>
            <span class="na">content-type=</span><span class="s">&quot;text/html&quot;</span><span class="nt">&gt;</span>

            <span class="nt">&lt;monolog:to-email&gt;</span>error@example.com<span class="nt">&lt;/monolog:to-email&gt;</span>

            <span class="c">&lt;!-- or list of recipients --&gt;</span>
            <span class="c">&lt;!--</span>
<span class="c">            &lt;monolog:to-email&gt;dev1@example.com&lt;/monolog:to-email&gt;</span>
<span class="c">            &lt;monolog:to-email&gt;dev2@example.com&lt;/monolog:to-email&gt;</span>
<span class="c">            ...</span>
<span class="c">            --&gt;</span>
        <span class="nt">&lt;/monolog:handler&gt;</span>
    <span class="nt">&lt;/monolog:config&gt;</span>
<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>PHP</em><div class="highlight-php notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/packages/prod/monolog.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;monolog&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;handlers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;main&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;fingers_crossed&#39;</span><span class="p">,</span>
            <span class="c1">// 500 errors are logged at the critical level</span>
            <span class="s1">&#39;action_level&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;critical&#39;</span><span class="p">,</span>
            <span class="c1">// to also log 400 level errors (but not 404&#39;s):</span>
            <span class="c1">// &#39;action_level&#39; =&gt; &#39;error&#39;,</span>
            <span class="c1">// &#39;excluded_404s&#39; =&gt; [</span>
            <span class="c1">//     &#39;^/&#39;,</span>
            <span class="c1">// ],</span>
            <span class="s1">&#39;handler&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;deduplicated&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;deduplicated&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;deduplication&#39;</span><span class="p">,</span>
            <span class="s1">&#39;handler&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;swift&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;swift&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;swift_mailer&#39;</span><span class="p">,</span>
            <span class="s1">&#39;from_email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;error@example.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;to_email&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;error@example.com&#39;</span><span class="p">,</span>
            <span class="c1">// or a list of recipients</span>
            <span class="c1">// &#39;to_email&#39;   =&gt; [&#39;dev1@example.com&#39;, &#39;dev2@example.com&#39;, ...],</span>
            <span class="s1">&#39;subject&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;An Error Occurred! %%message%%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span>
            <span class="s1">&#39;formatter&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;monolog.formatter.html&#39;</span><span class="p">,</span>
            <span class="s1">&#39;content_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</td></tr></table></div>
</p></li>
</ul>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> handler is a <code class="docutils literal notranslate"><span class="pre">fingers_crossed</span></code> handler which means that
it is only triggered when the action level, in this case <code class="docutils literal notranslate"><span class="pre">critical</span></code> is reached.
The <code class="docutils literal notranslate"><span class="pre">critical</span></code> level is only triggered for 5xx HTTP code errors. If this level
is reached once, the <code class="docutils literal notranslate"><span class="pre">fingers_crossed</span></code> handler will log all messages
regardless of their level. The <code class="docutils literal notranslate"><span class="pre">handler</span></code> setting means that the output
is then passed onto the <code class="docutils literal notranslate"><span class="pre">deduplicated</span></code> handler.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want both 400 level and 500 level errors to trigger an email,
set the <code class="docutils literal notranslate"><span class="pre">action_level</span></code> to <code class="docutils literal notranslate"><span class="pre">error</span></code> instead of <code class="docutils literal notranslate"><span class="pre">critical</span></code>. See the
code above for an example.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">deduplicated</span></code> handler keeps all the messages for a request and then
passes them onto the nested handler in one go, but only if the records are
unique over a given period of time (60 seconds by default). If the records are
duplicated they are discarded. Adding this handler reduces the amount of
notifications to a manageable level, specially in critical failure scenarios.
You can adjust the time period using the <code class="docutils literal notranslate"><span class="pre">time</span></code> option:</p>
<div class="configuration-block">
<ul class="simple">
<li><p><em>YAML</em><div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/prod/monolog.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">monolog</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">handlers</span><span class="p p-Indicator">:</span>
        <span class="c1"># ...</span>
        <span class="l l-Scalar l-Scalar-Plain">deduplicated</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">deduplication</span>
            <span class="c1"># the time in seconds during which duplicate entries are discarded (default: 60)</span>
            <span class="l l-Scalar l-Scalar-Plain">time</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
            <span class="l l-Scalar l-Scalar-Plain">handler</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">swift</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>XML</em><div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/packages/prod/monolog.xml --&gt;</span>

<span class="c">&lt;!-- time: the time in seconds during which duplicate entries are discarded (default: 60) --&gt;</span>
<span class="nt">&lt;monolog:handler</span> <span class="na">name=</span><span class="s">&quot;deduplicated&quot;</span>
    <span class="na">type=</span><span class="s">&quot;deduplication&quot;</span>
    <span class="na">time=</span><span class="s">&quot;10&quot;</span>
    <span class="na">handler=</span><span class="s">&quot;swift&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>PHP</em><div class="highlight-php notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/packages/prod/monolog.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;monolog&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;handlers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="c1">// ...</span>
        <span class="s1">&#39;deduplicated&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;deduplication&#39;</span><span class="p">,</span>
            <span class="c1">// the time in seconds during which duplicate entries are discarded (default: 60)</span>
            <span class="s1">&#39;time&#39;</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s1">&#39;handler&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;swift&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</td></tr></table></div>
</p></li>
</ul>
</div>
<p>The messages are then passed to the <code class="docutils literal notranslate"><span class="pre">swift</span></code> handler. This is the handler that
actually deals with emailing you the error. The settings for this are
straightforward, the to and from addresses, the formatter, the content type
and the subject.</p>
<p>You can combine these handlers with other handlers so that the errors still
get logged on the server as well as the emails being sent:</p>
<div class="configuration-block">
<ul class="simple">
<li><p><em>YAML</em><div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># config/packages/prod/monolog.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">monolog</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">handlers</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">main</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>         <span class="l l-Scalar l-Scalar-Plain">fingers_crossed</span>
            <span class="l l-Scalar l-Scalar-Plain">action_level</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">critical</span>
            <span class="l l-Scalar l-Scalar-Plain">handler</span><span class="p p-Indicator">:</span>      <span class="l l-Scalar l-Scalar-Plain">grouped</span>
        <span class="l l-Scalar l-Scalar-Plain">grouped</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>    <span class="l l-Scalar l-Scalar-Plain">group</span>
            <span class="l l-Scalar l-Scalar-Plain">members</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">streamed</span><span class="p p-Indicator">,</span> <span class="nv">deduplicated</span><span class="p p-Indicator">]</span>
        <span class="l l-Scalar l-Scalar-Plain">streamed</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>  <span class="l l-Scalar l-Scalar-Plain">stream</span>
            <span class="l l-Scalar l-Scalar-Plain">path</span><span class="p p-Indicator">:</span>  <span class="s">&#39;%kernel.logs_dir%/%kernel.environment%.log&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">level</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">debug</span>
        <span class="l l-Scalar l-Scalar-Plain">deduplicated</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>    <span class="l l-Scalar l-Scalar-Plain">deduplication</span>
            <span class="l l-Scalar l-Scalar-Plain">handler</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">swift</span>
        <span class="l l-Scalar l-Scalar-Plain">swift</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span>         <span class="l l-Scalar l-Scalar-Plain">swift_mailer</span>
            <span class="l l-Scalar l-Scalar-Plain">from_email</span><span class="p p-Indicator">:</span>   <span class="s">&#39;error@example.com&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">to_email</span><span class="p p-Indicator">:</span>     <span class="s">&#39;error@example.com&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">subject</span><span class="p p-Indicator">:</span>      <span class="s">&#39;An</span><span class="nv"> </span><span class="s">Error</span><span class="nv"> </span><span class="s">Occurred!</span><span class="nv"> </span><span class="s">%%message%%&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">level</span><span class="p p-Indicator">:</span>        <span class="l l-Scalar l-Scalar-Plain">debug</span>
            <span class="l l-Scalar l-Scalar-Plain">formatter</span><span class="p p-Indicator">:</span>    <span class="l l-Scalar l-Scalar-Plain">monolog.formatter.html</span>
            <span class="l l-Scalar l-Scalar-Plain">content_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">text/html</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>XML</em><div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">&lt;!-- config/packages/prod/monolog.xml --&gt;</span>
<span class="nt">&lt;container</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/services&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:monolog=</span><span class="s">&quot;http://symfony.com/schema/dic/monolog&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/services</span>
<span class="s">        https://symfony.com/schema/dic/services/services-1.0.xsd</span>
<span class="s">        http://symfony.com/schema/dic/monolog https://symfony.com/schema/dic/monolog/monolog-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;monolog:config&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;main&quot;</span>
            <span class="na">type=</span><span class="s">&quot;fingers_crossed&quot;</span>
            <span class="na">action_level=</span><span class="s">&quot;critical&quot;</span>
            <span class="na">handler=</span><span class="s">&quot;grouped&quot;</span>
        <span class="nt">/&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;grouped&quot;</span>
            <span class="na">type=</span><span class="s">&quot;group&quot;</span>
        <span class="nt">&gt;</span>
            <span class="nt">&lt;member</span> <span class="na">type=</span><span class="s">&quot;stream&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;member</span> <span class="na">type=</span><span class="s">&quot;deduplicated&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/monolog:handler&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;stream&quot;</span>
            <span class="na">path=</span><span class="s">&quot;%kernel.logs_dir%/%kernel.environment%.log&quot;</span>
            <span class="na">level=</span><span class="s">&quot;debug&quot;</span>
        <span class="nt">/&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;deduplicated&quot;</span>
            <span class="na">type=</span><span class="s">&quot;deduplication&quot;</span>
            <span class="na">handler=</span><span class="s">&quot;swift&quot;</span>
        <span class="nt">/&gt;</span>
        <span class="nt">&lt;monolog:handler</span>
            <span class="na">name=</span><span class="s">&quot;swift&quot;</span>
            <span class="na">type=</span><span class="s">&quot;swift_mailer&quot;</span>
            <span class="na">from-email=</span><span class="s">&quot;error@example.com&quot;</span>
            <span class="na">subject=</span><span class="s">&quot;An Error Occurred! %%message%%&quot;</span>
            <span class="na">level=</span><span class="s">&quot;debug&quot;</span>
            <span class="na">formatter=</span><span class="s">&quot;monolog.formatter.html&quot;</span>
            <span class="na">content-type=</span><span class="s">&quot;text/html&quot;</span><span class="nt">&gt;</span>

            <span class="nt">&lt;monolog:to-email&gt;</span>error@example.com<span class="nt">&lt;/monolog:to-email&gt;</span>

            <span class="c">&lt;!-- or list of recipients --&gt;</span>
            <span class="c">&lt;!--</span>
<span class="c">            &lt;monolog:to-email&gt;dev1@example.com&lt;/monolog:to-email&gt;</span>
<span class="c">            &lt;monolog:to-email&gt;dev2@example.com&lt;/monolog:to-email&gt;</span>
<span class="c">            ...</span>
<span class="c">            --&gt;</span>
        <span class="nt">&lt;/monolog:handler&gt;</span>
    <span class="nt">&lt;/monolog:config&gt;</span>
<span class="nt">&lt;/container&gt;</span>
</pre></div>
</td></tr></table></div>
</p></li>
<li><p><em>PHP</em><div class="highlight-php notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// config/packages/prod/monolog.php</span>
<span class="nv">$container</span><span class="o">-&gt;</span><span class="na">loadFromExtension</span><span class="p">(</span><span class="s1">&#39;monolog&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;handlers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;main&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;fingers_crossed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action_level&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;critical&#39;</span><span class="p">,</span>
            <span class="s1">&#39;handler&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;grouped&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;grouped&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span>
            <span class="s1">&#39;members&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;streamed&#39;</span><span class="p">,</span> <span class="s1">&#39;deduplicated&#39;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="s1">&#39;streamed&#39;</span>  <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;stream&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;%kernel.logs_dir%/%kernel.environment%.log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;deduplicated&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;deduplication&#39;</span><span class="p">,</span>
            <span class="s1">&#39;handler&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;swift&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;swift&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;type&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;swift_mailer&#39;</span><span class="p">,</span>
            <span class="s1">&#39;from_email&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;error@example.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;to_email&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;error@example.com&#39;</span><span class="p">,</span>
            <span class="c1">// or a list of recipients</span>
            <span class="c1">// &#39;to_email&#39;   =&gt; [&#39;dev1@example.com&#39;, &#39;dev2@example.com&#39;, ...],</span>
            <span class="s1">&#39;subject&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;An Error Occurred! %%message%%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span>
            <span class="s1">&#39;formatter&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;monolog.formatter.html&#39;</span><span class="p">,</span>
            <span class="s1">&#39;content_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</td></tr></table></div>
</p></li>
</ul>
</div>
<p>This uses the <code class="docutils literal notranslate"><span class="pre">group</span></code> handler to send the messages to the two
group members, the <code class="docutils literal notranslate"><span class="pre">deduplicated</span></code> and the <code class="docutils literal notranslate"><span class="pre">stream</span></code> handlers. The messages will
now be both written to the log file and emailed.</p>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>