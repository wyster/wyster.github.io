<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>The PSR-7 Bridge</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd_custom.css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-psr-7-bridge">
<span id="index-0"></span><h1>The PSR-7 Bridge</h1>
<blockquote>
<div><p>The PSR-7 bridge converts <a class="reference internal" href="http_foundation.xhtml"><span class="doc">HttpFoundation</span></a>
objects from and to objects implementing HTTP message interfaces defined
by the <a class="reference external" href="https://www.php-fig.org/psr/psr-7/">PSR-7</a><span class="link-target"> [https://www.php-fig.org/psr/psr-7/]</span>.</p>
</div></blockquote>
<div class="section" id="installation">
<h2>Installation</h2>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/psr-http-message-bridge
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you install this component outside of a Symfony application, you must
require the <code class="docutils literal notranslate"><span class="pre">vendor/autoload.php</span></code> file in your code to enable the class
autoloading mechanism provided by Composer. Read
<a class="reference internal" href="using_components.xhtml"><span class="doc">this article</span></a> for more details.</p>
</div>
<p>The bridge also needs a PSR-7 and <a class="reference external" href="https://www.php-fig.org/psr/psr-17/">PSR-17</a><span class="link-target"> [https://www.php-fig.org/psr/psr-17/]</span> implementation to convert
HttpFoundation objects to PSR-7 objects. The following command installs the
<code class="docutils literal notranslate"><span class="pre">nyholm/psr7</span></code> library, a lightweight and fast PSR-7 implementation, but you
can use any of the <a class="reference external" href="https://packagist.org/providers/psr/http-factory-implementation">libraries that implement psr/http-factory-implementation</a><span class="link-target"> [https://packagist.org/providers/psr/http-factory-implementation]</span>:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require nyholm/psr7
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<div class="section" id="converting-from-httpfoundation-objects-to-psr-7">
<h3>Converting from HttpFoundation Objects to PSR-7</h3>
<p>The bridge provides an interface of a factory called
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/PsrHttpMessage/HttpMessageFactoryInterface.php" title="Symfony\Bridge\PsrHttpMessage\HttpMessageFactoryInterface"><span class="pre">HttpMessageFactoryInterface</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/PsrHttpMessage/HttpMessageFactoryInterface.php]</span></span></code>
that builds objects implementing PSR-7 interfaces from HttpFoundation objects.</p>
<p>The following code snippet explains how to convert a <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php" title="Symfony\Component\HttpFoundation\Request"><span class="pre">Request</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php]</span></span></code>
to a <code class="docutils literal notranslate"><span class="pre">Nyholm\Psr7\ServerRequest</span></code> class implementing the
<code class="docutils literal notranslate"><span class="pre">Psr\Http\Message\ServerRequestInterface</span></code> interface:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Nyholm\Psr7\Factory\Psr17Factory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bridge\PsrHttpMessage\Factory\PsrHttpFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="nv">$symfonyRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Request</span><span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;HTTP_HOST&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dunglas.fr&#39;</span><span class="p">],</span> <span class="s1">&#39;Content&#39;</span><span class="p">);</span>
<span class="c1">// The HTTP_HOST server key must be set to avoid an unexpected error</span>

<span class="nv">$psr17Factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Psr17Factory</span><span class="p">();</span>
<span class="nv">$psrHttpFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PsrHttpFactory</span><span class="p">(</span><span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">);</span>
<span class="nv">$psrRequest</span> <span class="o">=</span> <span class="nv">$psrHttpFactory</span><span class="o">-&gt;</span><span class="na">createRequest</span><span class="p">(</span><span class="nv">$symfonyRequest</span><span class="p">);</span>
</pre></div>
</div>
<p>And now from a <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php" title="Symfony\Component\HttpFoundation\Response"><span class="pre">Response</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php]</span></span></code> to a
<code class="docutils literal notranslate"><span class="pre">Nyholm\Psr7\Response</span></code> class implementing the
<code class="docutils literal notranslate"><span class="pre">Psr\Http\Message\ResponseInterface</span></code> interface:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Nyholm\Psr7\Factory\Psr17Factory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Bridge\PsrHttpMessage\Factory\PsrHttpFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$symfonyResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Content&#39;</span><span class="p">);</span>

<span class="nv">$psr17Factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Psr17Factory</span><span class="p">();</span>
<span class="nv">$psrHttpFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PsrHttpFactory</span><span class="p">(</span><span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">,</span> <span class="nv">$psr17Factory</span><span class="p">);</span>
<span class="nv">$psrResponse</span> <span class="o">=</span> <span class="nv">$psrHttpFactory</span><span class="o">-&gt;</span><span class="na">createResponse</span><span class="p">(</span><span class="nv">$symfonyResponse</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-objects-implementing-psr-7-interfaces-to-httpfoundation">
<h3>Converting Objects implementing PSR-7 Interfaces to HttpFoundation</h3>
<p>On the other hand, the bridge provide a factory interface called
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/PsrHttpMessage/HttpFoundationFactoryInterface.php" title="Symfony\Bridge\PsrHttpMessage\HttpFoundationFactoryInterface"><span class="pre">HttpFoundationFactoryInterface</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/PsrHttpMessage/HttpFoundationFactoryInterface.php]</span></span></code>
that builds HttpFoundation objects from objects implementing PSR-7 interfaces.</p>
<p>The next snippet explain how to convert an object implementing the
<code class="docutils literal notranslate"><span class="pre">Psr\Http\Message\ServerRequestInterface</span></code> interface to a
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php" title="Symfony\Component\HttpFoundation\Request"><span class="pre">Request</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Request.php]</span></span></code> instance:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Bridge\PsrHttpMessage\Factory\HttpFoundationFactory</span><span class="p">;</span>

<span class="c1">// $psrRequest is an instance of Psr\Http\Message\ServerRequestInterface</span>

<span class="nv">$httpFoundationFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HttpFoundationFactory</span><span class="p">();</span>
<span class="nv">$symfonyRequest</span> <span class="o">=</span> <span class="nv">$httpFoundationFactory</span><span class="o">-&gt;</span><span class="na">createRequest</span><span class="p">(</span><span class="nv">$psrRequest</span><span class="p">);</span>
</pre></div>
</div>
<p>From an object implementing the <code class="docutils literal notranslate"><span class="pre">Psr\Http\Message\ResponseInterface</span></code>
to a <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php" title="Symfony\Component\HttpFoundation\Response"><span class="pre">Response</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpFoundation/Response.php]</span></span></code> instance:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Bridge\PsrHttpMessage\Factory\HttpFoundationFactory</span><span class="p">;</span>

<span class="c1">// $psrResponse is an instance of Psr\Http\Message\ResponseInterface</span>

<span class="nv">$httpFoundationFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HttpFoundationFactory</span><span class="p">();</span>
<span class="nv">$symfonyResponse</span> <span class="o">=</span> <span class="nv">$httpFoundationFactory</span><span class="o">-&gt;</span><span class="na">createResponse</span><span class="p">(</span><span class="nv">$psrResponse</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>