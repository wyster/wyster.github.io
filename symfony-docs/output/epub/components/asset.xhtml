<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>The Asset Component</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/rtd_custom.css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-asset-component">
<span id="index-0"></span><h1>The Asset Component</h1>
<blockquote>
<div><p>The Asset component manages URL generation and versioning of web assets such
as CSS stylesheets, JavaScript files and image files.</p>
</div></blockquote>
<p>In the past, it was common for web applications to hardcode URLs of web assets.
For example:</p>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/css/main.css&quot;</span><span class="p">&gt;</span>

<span class="c">&lt;!-- ... --&gt;</span>

<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/images/logo.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;logo&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>This practice is no longer recommended unless the web application is extremely
simple. Hardcoding URLs can be a disadvantage because:</p>
<ul class="simple">
<li><p><strong>Templates get verbose</strong>: you have to write the full path for each
asset. When using the Asset component, you can group assets in packages to
avoid repeating the common part of their path;</p></li>
<li><p><strong>Versioning is difficult</strong>: it has to be custom managed for each
application. Adding a version (e.g. <code class="docutils literal notranslate"><span class="pre">main.css?v=5</span></code>) to the asset URLs
is essential for some applications because it allows you to control how
the assets are cached. The Asset component allows you to define different
versioning strategies for each package;</p></li>
<li><p><strong>Moving assets’ location</strong> is cumbersome and error-prone: it requires you to
carefully update the URLs of all assets included in all templates. The Asset
component allows to move assets effortlessly just by changing the base path
value associated with the package of assets;</p></li>
<li><p><strong>It’s nearly impossible to use multiple CDNs</strong>: this technique requires
you to change the URL of the asset randomly for each request. The Asset component
provides out-of-the-box support for any number of multiple CDNs, both regular
(<code class="docutils literal notranslate"><span class="pre">http://</span></code>) and secure (<code class="docutils literal notranslate"><span class="pre">https://</span></code>).</p></li>
</ul>
<div class="section" id="installation">
<h2>Installation</h2>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/asset
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you install this component outside of a Symfony application, you must
require the <code class="docutils literal notranslate"><span class="pre">vendor/autoload.php</span></code> file in your code to enable the class
autoloading mechanism provided by Composer. Read
<a class="reference internal" href="using_components.xhtml"><span class="doc">this article</span></a> for more details.</p>
</div>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<div class="section" id="asset-packages">
<h3>Asset Packages</h3>
<p>The Asset component manages assets through packages. A package groups all the
assets which share the same properties: versioning strategy, base path, CDN hosts,
etc. In the following basic example, a package is created to manage assets without
any versioning:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Package</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\VersionStrategy\EmptyVersionStrategy</span><span class="p">;</span>

<span class="nv">$package</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="k">new</span> <span class="nx">EmptyVersionStrategy</span><span class="p">());</span>

<span class="c1">// Absolute path</span>
<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /image.png</span>

<span class="c1">// Relative path</span>
<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: image.png</span>
</pre></div>
</div>
<p>Packages implement <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php" title="Symfony\Component\Asset\PackageInterface"><span class="pre">PackageInterface</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php]</span></span></code>,
which defines the following two methods:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php" title="Symfony\Component\Asset\PackageInterface::getVersion()"><span class="pre">getVersion()</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php]</span></span></code></dt>
<dd><p>Returns the asset version for an asset.</p>
</dd>
<dt><code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php" title="Symfony\Component\Asset\PackageInterface::getUrl()"><span class="pre">getUrl()</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PackageInterface.php]</span></span></code></dt>
<dd><p>Returns an absolute or root-relative public path.</p>
</dd>
</dl>
<p>With a package, you can:</p>
<ol class="upperalpha simple">
<li><p><a class="reference internal" href="#component-assets-versioning"><span class="std std-ref">version the assets</span></a>;</p></li>
<li><p>set a <a class="reference internal" href="#component-assets-path-package"><span class="std std-ref">common base path</span></a> (e.g. <code class="docutils literal notranslate"><span class="pre">/css</span></code>)
for the assets;</p></li>
<li><p><a class="reference internal" href="#component-assets-cdn"><span class="std std-ref">configure a CDN</span></a> for the assets</p></li>
</ol>
</div>
<div class="section" id="versioned-assets">
<span id="component-assets-versioning"></span><h3>Versioned Assets</h3>
<p>One of the main features of the Asset component is the ability to manage
the versioning of the application’s assets. Asset versions are commonly used
to control how these assets are cached.</p>
<p>Instead of relying on a simple version mechanism, the Asset component allows
you to define advanced versioning strategies via PHP classes. The two built-in
strategies are the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/EmptyVersionStrategy.php" title="Symfony\Component\Asset\VersionStrategy\EmptyVersionStrategy"><span class="pre">EmptyVersionStrategy</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/EmptyVersionStrategy.php]</span></span></code>,
which doesn’t add any version to the asset and <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/StaticVersionStrategy.php" title="Symfony\Component\Asset\VersionStrategy\StaticVersionStrategy"><span class="pre">StaticVersionStrategy</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/StaticVersionStrategy.php]</span></span></code>,
which allows you to set the version with a format string.</p>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">StaticVersionStrategy</span></code> is used to append the <code class="docutils literal notranslate"><span class="pre">v1</span></code>
suffix to any asset path:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Package</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\VersionStrategy\StaticVersionStrategy</span><span class="p">;</span>

<span class="nv">$package</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">));</span>

<span class="c1">// Absolute path</span>
<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /image.png?v1</span>

<span class="c1">// Relative path</span>
<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: image.png?v1</span>
</pre></div>
</div>
<p>In case you want to modify the version format, pass a <code class="docutils literal notranslate"><span class="pre">sprintf</span></code>-compatible
format string as the second argument of the <code class="docutils literal notranslate"><span class="pre">StaticVersionStrategy</span></code>
constructor:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// puts the &#39;version&#39; word before the version value</span>
<span class="nv">$package</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;%s?version=%s&#39;</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /image.png?version=v1</span>

<span class="c1">// puts the asset version before its path</span>
<span class="nv">$package</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;%2$s/%1$s&#39;</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /v1/image.png</span>

<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">);</span>
<span class="c1">// result: v1/image.png</span>
</pre></div>
</div>
<div class="section" id="json-file-manifest">
<h4>JSON File Manifest</h4>
<p>A popular strategy to manage asset versioning, which is used by tools such as
<a class="reference external" href="https://webpack.js.org/">Webpack</a><span class="link-target"> [https://webpack.js.org/]</span>, is to generate a JSON file mapping all source file names to their
corresponding output file:</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;css/app.css&quot;</span><span class="p">:</span> <span class="s2">&quot;build/css/app.b916426ea1d10021f3f17ce8031f93c2.css&quot;</span><span class="p">,</span>
    <span class="nt">&quot;js/app.js&quot;</span><span class="p">:</span> <span class="s2">&quot;build/js/app.13630905267b809161e71d0f8a0c017b.js&quot;</span><span class="p">,</span>
    <span class="nt">&quot;...&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>In those cases, use the
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/JsonManifestVersionStrategy.php" title="Symfony\Component\Asset\VersionStrategy\JsonManifestVersionStrategy"><span class="pre">JsonManifestVersionStrategy</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/JsonManifestVersionStrategy.php]</span></span></code>:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Package</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\VersionStrategy\JsonManifestVersionStrategy</span><span class="p">;</span>

<span class="c1">// assumes the JSON file above is called &quot;rev-manifest.json&quot;</span>
<span class="nv">$package</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="k">new</span> <span class="nx">JsonManifestVersionStrategy</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/rev-manifest.json&#39;</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;css/app.css&#39;</span><span class="p">);</span>
<span class="c1">// result: build/css/app.b916426ea1d10021f3f17ce8031f93c2.css</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-version-strategies">
<h4>Custom Version Strategies</h4>
<p>Use the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/VersionStrategyInterface.php" title="Symfony\Component\Asset\VersionStrategy\VersionStrategyInterface"><span class="pre">VersionStrategyInterface</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/VersionStrategy/VersionStrategyInterface.php]</span></span></code>
to define your own versioning strategy. For example, your application may need
to append the current date to all its web assets in order to bust the cache
every day:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\VersionStrategy\VersionStrategyInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DateVersionStrategy</span> <span class="k">implements</span> <span class="nx">VersionStrategyInterface</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$version</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Ymd&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getVersion</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">applyVersion</span><span class="p">(</span><span class="nv">$path</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">&#39;%s?v=%s&#39;</span><span class="p">,</span> <span class="nv">$path</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getVersion</span><span class="p">(</span><span class="nv">$path</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="grouped-assets">
<span id="component-assets-path-package"></span><h3>Grouped Assets</h3>
<p>Often, many assets live under a common path (e.g. <code class="docutils literal notranslate"><span class="pre">/static/images</span></code>). If
that’s your case, replace the default <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/Package.php" title="Symfony\Component\Asset\Package"><span class="pre">Package</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/Package.php]</span></span></code>
class with <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PathPackage.php" title="Symfony\Component\Asset\PathPackage"><span class="pre">PathPackage</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/PathPackage.php]</span></span></code> to avoid repeating
that path over and over again:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\PathPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$pathPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PathPackage</span><span class="p">(</span><span class="s1">&#39;/static/images&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$pathPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /static/images/logo.png?v1</span>

<span class="c1">// Base path is ignored when using absolute paths</span>
<span class="k">echo</span> <span class="nv">$pathPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /logo.png?v1</span>
</pre></div>
</div>
<div class="section" id="request-context-aware-assets">
<h4>Request Context Aware Assets</h4>
<p>If you are also using the <a class="reference internal" href="http_foundation.xhtml"><span class="doc">HttpFoundation</span></a>
component in your project (for instance, in a Symfony application), the <code class="docutils literal notranslate"><span class="pre">PathPackage</span></code>
class can take into account the context of the current request:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Context\RequestStackContext</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\PathPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$pathPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PathPackage</span><span class="p">(</span>
    <span class="s1">&#39;/static/images&#39;</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">),</span>
    <span class="k">new</span> <span class="nx">RequestStackContext</span><span class="p">(</span><span class="nv">$requestStack</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$pathPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /somewhere/static/images/logo.png?v1</span>

<span class="c1">// Both &quot;base path&quot; and &quot;base url&quot; are ignored when using absolute path for asset</span>
<span class="k">echo</span> <span class="nv">$pathPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: /logo.png?v1</span>
</pre></div>
</div>
<p>Now that the request context is set, the <code class="docutils literal notranslate"><span class="pre">PathPackage</span></code> will prepend the
current request base URL. So, for example, if your entire site is hosted under
the <code class="docutils literal notranslate"><span class="pre">/somewhere</span></code> directory of your web server root directory and the configured
base path is <code class="docutils literal notranslate"><span class="pre">/static/images</span></code>, all paths will be prefixed with
<code class="docutils literal notranslate"><span class="pre">/somewhere/static/images</span></code>.</p>
</div>
</div>
<div class="section" id="absolute-assets-and-cdns">
<span id="component-assets-cdn"></span><h3>Absolute Assets and CDNs</h3>
<p>Applications that host their assets on different domains and CDNs (<em>Content
Delivery Networks</em>) should use the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/UrlPackage.php" title="Symfony\Component\Asset\UrlPackage"><span class="pre">UrlPackage</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/UrlPackage.php]</span></span></code>
class to generate absolute URLs for their assets:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$urlPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span>
    <span class="s1">&#39;http://static.example.com/images/&#39;</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$urlPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: http://static.example.com/images/logo.png?v1</span>
</pre></div>
</div>
<p>You can also pass a schema-agnostic URL:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$urlPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span>
    <span class="s1">&#39;//static.example.com/images/&#39;</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$urlPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: //static.example.com/images/logo.png?v1</span>
</pre></div>
</div>
<p>This is useful because assets will automatically be requested via HTTPS if
a visitor is viewing your site in https. If you want to use this, make sure
that your CDN host supports HTTPS.</p>
<p>In case you serve assets from more than one domain to improve application
performance, pass an array of URLs as the first argument to the <code class="docutils literal notranslate"><span class="pre">UrlPackage</span></code>
constructor:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;//static1.example.com/images/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;//static2.example.com/images/&#39;</span><span class="p">,</span>
<span class="p">];</span>
<span class="nv">$urlPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span><span class="nv">$urls</span><span class="p">,</span> <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$urlPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: http://static1.example.com/images/logo.png?v1</span>
<span class="k">echo</span> <span class="nv">$urlPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/icon.png&#39;</span><span class="p">);</span>
<span class="c1">// result: http://static2.example.com/images/icon.png?v1</span>
</pre></div>
</div>
<p>For each asset, one of the URLs will be randomly used. But, the selection
is deterministic, meaning that each asset will always be served by the same
domain. This behavior simplifies the management of HTTP cache.</p>
<div class="section" id="id1">
<h4>Request Context Aware Assets</h4>
<p>Similarly to application-relative assets, absolute assets can also take into
account the context of the current request. In this case, only the request
scheme is considered, in order to select the appropriate base URL (HTTPs or
protocol-relative URLs for HTTPs requests, any base URL for HTTP requests):</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Context\RequestStackContext</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$urlPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;http://example.com/&#39;</span><span class="p">,</span> <span class="s1">&#39;https://example.com/&#39;</span><span class="p">],</span>
    <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">),</span>
    <span class="k">new</span> <span class="nx">RequestStackContext</span><span class="p">(</span><span class="nv">$requestStack</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$urlPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// assuming the RequestStackContext says that we are on a secure host</span>
<span class="c1">// result: https://example.com/logo.png?v1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="named-packages">
<h3>Named Packages</h3>
<p>Applications that manage lots of different assets may need to group them in
packages with the same versioning strategy and base path. The Asset component
includes a <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/Packages.php" title="Symfony\Component\Asset\Packages"><span class="pre">Packages</span></a><span class="link-target"> <span class="pre">[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Asset/Packages.php]</span></span></code> class to simplify
management of several packages.</p>
<p>In the following example, all packages use the same versioning strategy, but
they all have different base paths:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\Package</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\Packages</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\PathPackage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$versionStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StaticVersionStrategy</span><span class="p">(</span><span class="s1">&#39;v1&#39;</span><span class="p">);</span>

<span class="nv">$defaultPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Package</span><span class="p">(</span><span class="nv">$versionStrategy</span><span class="p">);</span>

<span class="nv">$namedPackages</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;img&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span><span class="s1">&#39;http://img.example.com/&#39;</span><span class="p">,</span> <span class="nv">$versionStrategy</span><span class="p">),</span>
    <span class="s1">&#39;doc&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">PathPackage</span><span class="p">(</span><span class="s1">&#39;/somewhere/deep/for/documents&#39;</span><span class="p">,</span> <span class="nv">$versionStrategy</span><span class="p">),</span>
<span class="p">];</span>

<span class="nv">$packages</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Packages</span><span class="p">(</span><span class="nv">$defaultPackage</span><span class="p">,</span> <span class="nv">$namedPackages</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Packages</span></code> class allows to define a default package, which will be applied
to assets that don’t define the name of package to use. In addition, this
application defines a package named <code class="docutils literal notranslate"><span class="pre">img</span></code> to serve images from an external
domain and a <code class="docutils literal notranslate"><span class="pre">doc</span></code> package to avoid repeating long paths when linking to a
document inside a template:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">echo</span> <span class="nv">$packages</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/main.css&#39;</span><span class="p">);</span>
<span class="c1">// result: /main.css?v1</span>

<span class="k">echo</span> <span class="nv">$packages</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">,</span> <span class="s1">&#39;img&#39;</span><span class="p">);</span>
<span class="c1">// result: http://img.example.com/logo.png?v1</span>

<span class="k">echo</span> <span class="nv">$packages</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;resume.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;doc&#39;</span><span class="p">);</span>
<span class="c1">// result: /somewhere/deep/for/documents/resume.pdf?v1</span>
</pre></div>
</div>
</div>
<div class="section" id="local-files-and-other-protocols">
<h3>Local Files and Other Protocols</h3>
<p>In addition to HTTP this component supports other protocols (such as <code class="docutils literal notranslate"><span class="pre">file://</span></code>
and <code class="docutils literal notranslate"><span class="pre">ftp://</span></code>). This allows for example to serve local files in order to
improve performance:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\Asset\UrlPackage</span><span class="p">;</span>
<span class="c1">// ...</span>

<span class="nv">$localPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span>
    <span class="s1">&#39;file:///path/to/images/&#39;</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">EmptyVersionStrategy</span><span class="p">()</span>
<span class="p">);</span>

<span class="nv">$ftpPackage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UrlPackage</span><span class="p">(</span>
    <span class="s1">&#39;ftp://example.com/images/&#39;</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">EmptyVersionStrategy</span><span class="p">()</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$localPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: file:///path/to/images/logo.png</span>

<span class="k">echo</span> <span class="nv">$ftpPackage</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;/logo.png&#39;</span><span class="p">);</span>
<span class="c1">// result: ftp://example.com/images/logo.png</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="learn-more">
<h2>Learn more</h2>
<ul class="simple">
<li><p><a class="reference internal" href="../frontend.xhtml"><span class="doc">How to manage CSS and JavaScript assets in Symfony applications</span></a></p></li>
<li><p><a class="reference internal" href="../web_link.xhtml"><span class="doc">WebLink component</span></a> to preload assets using HTTP/2.</p></li>
</ul>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>