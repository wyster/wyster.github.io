

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>When and How to Use Data Mappers &mdash; Symfony Framework Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/rtd_custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to Create a Form Type Extension" href="create_form_type_extension.html" />
    <link rel="prev" title="How to Use Data Transformers" href="data_transformers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #f0f0f0" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/symfony-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.2}
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_tour/index.html">The Quick Tour</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../best_practices.html">The Symfony Framework Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundles.html">The Bundle System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console.html">Console Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doctrine.html">Databases and the Doctrine ORM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">How to Deploy a Symfony Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../email.html">Swift Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_dispatcher.html">Events and Event Listeners</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../forms.html">Forms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../forms.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#building-forms">Building Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#rendering-forms">Rendering Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#processing-forms">Processing Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#validating-forms">Validating Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms.html#other-common-form-features">Other Common Form Features</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../forms.html#learn-more">Learn more</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../reference/forms/types.html">Form Types Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controller/upload_file.html">How to Upload Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/csrf.html">How to Implement CSRF Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="form_dependencies.html">How to Access Services or Config from Inside a Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="create_custom_field_type.html">How to Create a Custom Form Field Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_transformers.html">How to Use Data Transformers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">When and How to Use Data Mappers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-difference-between-data-transformers-and-mappers">The Difference between Data Transformers and Mappers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-data-mapper">Creating a Data Mapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-mapper">Using the Mapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mapping-form-fields-using-callbacks">Mapping Form Fields Using Callbacks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="create_form_type_extension.html">How to Create a Form Type Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="type_guesser.html">Creating a custom Type Guesser</a></li>
<li class="toctree-l3"><a class="reference internal" href="bootstrap4.html">Bootstrap 4 Form Theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="form_customization.html">How to Customize Form Rendering</a></li>
<li class="toctree-l3"><a class="reference internal" href="form_themes.html">How to Work with Form Themes</a></li>
<li class="toctree-l3"><a class="reference internal" href="events.html">Form Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic_form_modification.html">How to Dynamically Modify Forms Using Form Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="validation_groups.html">How to Define the Validation Groups to Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="validation_group_service_resolver.html">How to Dynamically Configure Form Validation Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="button_based_validation.html">How to Choose Validation Groups Based on the Clicked Button</a></li>
<li class="toctree-l3"><a class="reference internal" href="disabling_validation.html">How to Disable the Validation of Submitted Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="direct_submit.html">How to Use the submit() Function to Handle Form Submissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="embedded.html">How to Embed Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="form_collections.html">How to Embed a Collection of Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="inherit_data_option.html">How to Reduce Code Duplication with “inherit_data”</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiple_buttons.html">How to Submit a Form with Multiple Buttons</a></li>
<li class="toctree-l3"><a class="reference internal" href="unit_testing.html">How to Unit Test your Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="use_empty_data.html">How to Configure empty Data for a Form Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="without_class.html">How to Use a Form without a Data Class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../frontend.html">Managing CSS and JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_cache.html">HTTP Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_client.html">HTTP Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lock.html">Dealing with Concurrency with Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mailer.html">Sending Emails with Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mercure.html">Pushing Data to Clients Using the Mercure Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../messenger.html">Messenger: Sync &amp; Queued Message Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating an Existing Application to Symfony</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notifier.html">Creating and Sending Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiler.html">Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rate_limiter.html">Rate Limiter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serializer.html">How to Use the Serializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_container.html">Service Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../translation.html">Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validation.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_link.html">Asset Preloading and Resource Hints with HTTP/2 and WebLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components/index.html">The Components</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Documents</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../create_framework/index.html">Create your own PHP Framework</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Symfony Framework Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../forms.html">Forms</a> &raquo;</li>
        
      <li>When and How to Use Data Mappers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/form/data_mappers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="when-and-how-to-use-data-mappers">
<span id="index-0"></span><h1>When and How to Use Data Mappers<a class="headerlink" href="#when-and-how-to-use-data-mappers" title="Permalink to this headline">¶</a></h1>
<p>When a form is compound, the initial data needs to be passed to children so each can display their
own input value. On submission, children values need to be written back into the form.</p>
<p>Data mappers are responsible for reading and writing data from and into parent forms.</p>
<p>The main built-in data mapper uses the <a class="reference internal" href="../components/property_access.html"><span class="doc">PropertyAccess component</span></a>
and will fit most cases. However, you can create your own implementation that
could, for example, pass submitted data to immutable objects via their constructor.</p>
<div class="section" id="the-difference-between-data-transformers-and-mappers">
<h2>The Difference between Data Transformers and Mappers<a class="headerlink" href="#the-difference-between-data-transformers-and-mappers" title="Permalink to this headline">¶</a></h2>
<p>It is important to know the difference between
<a class="reference internal" href="data_transformers.html"><span class="doc">data transformers</span></a> and mappers.</p>
<ul class="simple">
<li><strong>Data transformers</strong> change the representation of a value (e.g. from
<code class="docutils literal notranslate"><span class="pre">&quot;2016-08-12&quot;</span></code> to a <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> instance);</li>
<li><strong>Data mappers</strong> map data (e.g. an object or array) to form fields, and vice versa.</li>
</ul>
<p>Changing a <code class="docutils literal notranslate"><span class="pre">YYYY-mm-dd</span></code> string value to a <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> instance is done by a
data transformer. Populating inner fields (e.g year, hour, etc) of a compound date type using
a <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> instance is done by the data mapper.</p>
</div>
<div class="section" id="creating-a-data-mapper">
<h2>Creating a Data Mapper<a class="headerlink" href="#creating-a-data-mapper" title="Permalink to this headline">¶</a></h2>
<p>Suppose that you want to save a set of colors to the database. For this, you’re
using an immutable color object:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// src/Painting/Color.php</span>
<span class="k">namespace</span> <span class="nx">App\Painting</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">Color</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$red</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$green</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$blue</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">int</span> <span class="nv">$red</span><span class="p">,</span> <span class="nx">int</span> <span class="nv">$green</span><span class="p">,</span> <span class="nx">int</span> <span class="nv">$blue</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">red</span> <span class="o">=</span> <span class="nv">$red</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">green</span> <span class="o">=</span> <span class="nv">$green</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">blue</span> <span class="o">=</span> <span class="nv">$blue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRed</span><span class="p">()</span><span class="o">:</span> <span class="nx">int</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">red</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getGreen</span><span class="p">()</span><span class="o">:</span> <span class="nx">int</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">green</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getBlue</span><span class="p">()</span><span class="o">:</span> <span class="nx">int</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">blue</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The form type should be allowed to edit a color. But because you’ve decided to
make the <code class="docutils literal notranslate"><span class="pre">Color</span></code> object immutable, a new color object has to be created each time
one of the values is changed.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you’re using a mutable object with constructor arguments, instead of
using a data mapper, you should configure the <code class="docutils literal notranslate"><span class="pre">empty_data</span></code> option with a closure
as described in
<a class="reference internal" href="use_empty_data.html#forms-empty-data-closure"><span class="std std-ref">How to Configure empty Data for a Form Class</span></a>.</p>
</div>
<p>The red, green and blue form fields have to be mapped to the constructor
arguments and the <code class="docutils literal notranslate"><span class="pre">Color</span></code> instance has to be mapped to red, green and blue
form fields. Recognize a familiar pattern? It’s time for a data mapper. The
easiest way to create one is by implementing <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/DataMapperInterface.php" title="Symfony\Component\Form\DataMapperInterface"><span class="pre">DataMapperInterface</span></a></code>
in your form type:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// src/Form/ColorType.php</span>
<span class="k">namespace</span> <span class="nx">App\Form</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Painting\Color</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\AbstractType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\DataMapperInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Exception\UnexpectedTypeException</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormInterface</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">ColorType</span> <span class="k">extends</span> <span class="nx">AbstractType</span> <span class="k">implements</span> <span class="nx">DataMapperInterface</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="sd">/**</span>
<span class="sd">     * @param Color|null $viewData</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">mapDataToForms</span><span class="p">(</span><span class="nv">$viewData</span><span class="p">,</span> <span class="nx">iterable</span> <span class="nv">$forms</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// there is no data yet, so nothing to prepopulate</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">null</span> <span class="o">===</span> <span class="nv">$viewData</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// invalid data type</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$viewData</span> <span class="nx">instanceof</span> <span class="nx">Color</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">UnexpectedTypeException</span><span class="p">(</span><span class="nv">$viewData</span><span class="p">,</span> <span class="nx">Color</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="sd">/** @var FormInterface[] $forms */</span>
        <span class="nv">$forms</span> <span class="o">=</span> <span class="nb">iterator_to_array</span><span class="p">(</span><span class="nv">$forms</span><span class="p">);</span>

        <span class="c1">// initialize form field values</span>
        <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$viewData</span><span class="o">-&gt;</span><span class="na">getRed</span><span class="p">());</span>
        <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$viewData</span><span class="o">-&gt;</span><span class="na">getGreen</span><span class="p">());</span>
        <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$viewData</span><span class="o">-&gt;</span><span class="na">getBlue</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">mapFormsToData</span><span class="p">(</span><span class="nx">iterable</span> <span class="nv">$forms</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$viewData</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="sd">/** @var FormInterface[] $forms */</span>
        <span class="nv">$forms</span> <span class="o">=</span> <span class="nb">iterator_to_array</span><span class="p">(</span><span class="nv">$forms</span><span class="p">);</span>

        <span class="c1">// as data is passed by reference, overriding it will change it in</span>
        <span class="c1">// the form object as well</span>
        <span class="c1">// beware of type inconsistency, see caution below</span>
        <span class="nv">$viewData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span>
            <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">(),</span>
            <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">(),</span>
            <span class="nv">$forms</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">()</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">The data passed to the mapper is <em>not yet validated</em>. This means that your
objects should allow being created in an invalid state in order to produce
user-friendly errors in the form.</p>
</div>
</div>
<div class="section" id="using-the-mapper">
<h2>Using the Mapper<a class="headerlink" href="#using-the-mapper" title="Permalink to this headline">¶</a></h2>
<p>After creating the data mapper, you need to configure the form to use it. This is
achieved using the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/FormConfigBuilderInterface.php" title="Symfony\Component\Form\FormConfigBuilderInterface::setDataMapper()"><span class="pre">setDataMapper()</span></a></code>
method:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// src/Form/Type/ColorType.php</span>
<span class="k">namespace</span> <span class="nx">App\Form\Type</span><span class="p">;</span>

<span class="c1">// ...</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\Extension\Core\Type\IntegerType</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormBuilderInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\OptionsResolver\OptionsResolver</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">ColorType</span> <span class="k">extends</span> <span class="nx">AbstractType</span> <span class="k">implements</span> <span class="nx">DataMapperInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">buildForm</span><span class="p">(</span><span class="nx">FormBuilderInterface</span> <span class="nv">$builder</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$builder</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="nx">IntegerType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
                <span class="c1">// enforce the strictness of the type to ensure the constructor</span>
                <span class="c1">// of the Color class doesn&#39;t break</span>
                <span class="s1">&#39;empty_data&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
            <span class="p">])</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="nx">IntegerType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
                <span class="s1">&#39;empty_data&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
            <span class="p">])</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="nx">IntegerType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
                <span class="s1">&#39;empty_data&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
            <span class="p">])</span>
            <span class="c1">// configure the data mapper for this FormType</span>
            <span class="o">-&gt;</span><span class="na">setDataMapper</span><span class="p">(</span><span class="nv">$this</span><span class="p">)</span>
        <span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">configureOptions</span><span class="p">(</span><span class="nx">OptionsResolver</span> <span class="nv">$resolver</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// when creating a new color, the initial data should be null</span>
        <span class="nv">$resolver</span><span class="o">-&gt;</span><span class="na">setDefault</span><span class="p">(</span><span class="s1">&#39;empty_data&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cool! When using the <code class="docutils literal notranslate"><span class="pre">ColorType</span></code> form, the custom data mapper methods will
create a new <code class="docutils literal notranslate"><span class="pre">Color</span></code> object now.</p>
</div>
<div class="section" id="mapping-form-fields-using-callbacks">
<h2>Mapping Form Fields Using Callbacks<a class="headerlink" href="#mapping-form-fields-using-callbacks" title="Permalink to this headline">¶</a></h2>
<p>Conveniently, you can also map data from and into a form field by using the
<code class="docutils literal notranslate"><span class="pre">getter</span></code> and <code class="docutils literal notranslate"><span class="pre">setter</span></code> options. For example, suppose you have a form with some
fields and only one of them needs to be mapped in some special way or you only
need to change how it’s written into the underlying object. In that case, register
a PHP callable that is able to write or read to/from that specific object:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">buildForm</span><span class="p">(</span><span class="nx">FormBuilderInterface</span> <span class="nv">$builder</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="nv">$builder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="nx">ChoiceType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;active&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">&#39;paused&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;getter&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Task</span> <span class="nv">$task</span><span class="p">,</span> <span class="nx">FormInterface</span> <span class="nv">$form</span><span class="p">)</span><span class="o">:</span> <span class="nx">bool</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">!</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="na">isCancelled</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="na">isPaused</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="s1">&#39;setter&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Task</span> <span class="o">&amp;</span><span class="nv">$task</span><span class="p">,</span> <span class="nx">bool</span> <span class="nv">$state</span><span class="p">,</span> <span class="nx">FormInterface</span> <span class="nv">$form</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$state</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$task</span><span class="o">-&gt;</span><span class="na">activate</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nv">$task</span><span class="o">-&gt;</span><span class="na">pause</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If available, these options have priority over the property path accessor and
the default data mapper will still use the <a class="reference internal" href="../components/property_access.html"><span class="doc">PropertyAccess component</span></a>
for the other form fields.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.2: </span>The <code class="docutils literal notranslate"><span class="pre">getter</span></code> and <code class="docutils literal notranslate"><span class="pre">setter</span></code> options were introduced in Symfony 5.2.</p>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">When a form has the <code class="docutils literal notranslate"><span class="pre">inherit_data</span></code> option set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, it does not use the data mapper and
lets its parent map inner values.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2004-2020 Fabien Potencier

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>