

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting a Stack Trace &mdash; Symfony Framework Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/rtd_custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating a Bug Reproducer" href="reproducer.html" />
    <link rel="prev" title="Reporting a Bug" href="bugs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #f0f0f0" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/symfony-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.2}
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick_tour/index.html">The Quick Tour</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../best_practices.html">The Symfony Framework Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bundles.html">The Bundle System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../console.html">Console Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doctrine.html">Databases and the Doctrine ORM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment.html">How to Deploy a Symfony Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../email.html">Swift Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../event_dispatcher.html">Events and Event Listeners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../forms.html">Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../frontend.html">Managing CSS and JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../http_cache.html">HTTP Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../http_client.html">HTTP Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lock.html">Dealing with Concurrency with Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mailer.html">Sending Emails with Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mercure.html">Pushing Data to Clients Using the Mercure Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../messenger.html">Messenger: Sync &amp; Queued Message Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration.html">Migrating an Existing Application to Symfony</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notifier.html">Creating and Sending Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profiler.html">Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rate_limiter.html">Rate Limiter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../session.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../serializer.html">How to Use the Serializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../service_container.html">Service Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation.html">Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../validation.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web_link.html">Asset Preloading and Resource Hints with HTTP/2 and WebLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow.html">Workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../components/index.html">The Components</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference Documents</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../code_of_conduct/index.html">Code of Conduct</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Contributing Code</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bugs.html">Reporting a Bug</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Getting a Stack Trace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#anatomy-of-a-stack-trace">Anatomy of a Stack Trace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack-traces-and-exceptions">Stack Traces and Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nested-exceptions">Nested Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-to-look-for-in-a-stack-trace">What to look for in a Stack Trace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-stack-traces-with-symfony">Getting Stack Traces with Symfony</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reproducer.html">Creating a Bug Reproducer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pull_requests.html">Proposing a Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="maintenance.html">Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="core_team.html">Symfony Core Team</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html">Security Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="tests.html">Running Symfony Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="bc.html">Our Backward Compatibility Promise</a></li>
<li class="toctree-l3"><a class="reference internal" href="experimental.html">Experimental Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="standards.html">Coding Standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="git.html">Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html">Symfony Code License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/index.html">Contributing Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community/index.html">Community</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diversity/index.html">Diversity Initiative</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../create_framework/index.html">Create your own PHP Framework</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Symfony Framework Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Contributing</a> &raquo;</li>
        
          <li><a href="index.html">Contributing Code</a> &raquo;</li>
        
      <li>Getting a Stack Trace</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/contributing/code/stack_trace.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-a-stack-trace">
<h1>Getting a Stack Trace<a class="headerlink" href="#getting-a-stack-trace" title="Permalink to this headline">¶</a></h1>
<p>When <a class="reference internal" href="bugs.html"><span class="doc">reporting a bug</span></a> for an
exception or a wrong behavior in code, it is crucial that you provide
one or several stack traces. To understand why, you first have to
understand what a stack trace is, and how it can be useful to you as a
developer, and also to library maintainers.</p>
<div class="section" id="anatomy-of-a-stack-trace">
<h2>Anatomy of a Stack Trace<a class="headerlink" href="#anatomy-of-a-stack-trace" title="Permalink to this headline">¶</a></h2>
<p>A stack trace is called that way because it allows one to see a trail of
function calls leading to a point in code since the beginning of the
program. That point is not necessarily an exception. For instance, you
can use the native PHP function <code class="docutils literal notranslate"><span class="pre">debug_print_backtrace()</span></code> to get such
a trace. For each line in the trace, you get a file and a function or
method call, and the line number for that call. This is often of great
help for understanding the flow of your program and how it can end up in
unexpected places, such as lines of code where exceptions are thrown.</p>
</div>
<div class="section" id="stack-traces-and-exceptions">
<h2>Stack Traces and Exceptions<a class="headerlink" href="#stack-traces-and-exceptions" title="Permalink to this headline">¶</a></h2>
<p>In PHP, every exception comes with its own stack trace, which is
displayed by default if the exception is not caught. When using Symfony,
such exceptions go through a custom exception handler, which enhances
them in various ways before displaying them according to the current
Server API (CLI or not).
This means a better way to get a stack trace when you do not need the
program to continue is to throw an exception, as follows:
<code class="docutils literal notranslate"><span class="pre">throw</span> <span class="pre">new</span> <span class="pre">\Exception();</span></code></p>
</div>
<div class="section" id="nested-exceptions">
<h2>Nested Exceptions<a class="headerlink" href="#nested-exceptions" title="Permalink to this headline">¶</a></h2>
<p>When applications get bigger, complexity is often tackled with layers of
architecture that need to be kept separate. For instance, if you have a
web application that makes a call to a remote API, it might be good to
wrap exceptions thrown when making that call with exceptions that have
special meaning in your domain, and to build appropriate HTTP exceptions
from those. Exceptions can be nested by using the <code class="docutils literal notranslate"><span class="pre">$previous</span></code>
argument that appears in the signature of the <code class="docutils literal notranslate"><span class="pre">Exception</span></code> class:
<code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">__construct</span> <span class="pre">([</span> <span class="pre">string</span> <span class="pre">$message</span> <span class="pre">=</span> <span class="pre">&quot;&quot;</span> <span class="pre">[,</span> <span class="pre">int</span> <span class="pre">$code</span> <span class="pre">=</span> <span class="pre">0</span> <span class="pre">[,</span> <span class="pre">Throwable</span> <span class="pre">$previous</span> <span class="pre">=</span> <span class="pre">NULL</span> <span class="pre">]]]</span> <span class="pre">)</span></code>
This means that sometimes, when you get an exception from an
application, you might actually get several of them.</p>
</div>
<div class="section" id="what-to-look-for-in-a-stack-trace">
<h2>What to look for in a Stack Trace<a class="headerlink" href="#what-to-look-for-in-a-stack-trace" title="Permalink to this headline">¶</a></h2>
<p>When using a library, you will call code that you did not write. When
using a framework, it is the opposite: because you follow the
conventions of the framework, <a class="reference external" href="https://en.wikipedia.org/wiki/Inversion_of_control">the framework finds your code and calls
it</a>, and does
things for you beforehand, like routing or access control.
Symfony being both a framework and library of components, it calls your
code and then your code might call it. This means you will always have
at least 2 parts, very often 3 in your stack traces when using Symfony:
a part that starts in one of the entrypoints of the framework
(<code class="docutils literal notranslate"><span class="pre">bin/console</span></code> or <code class="docutils literal notranslate"><span class="pre">public/index.php</span></code> in most cases), and ends when
reaching your code, most times in a command or in a controller found under
<code class="docutils literal notranslate"><span class="pre">src</span></code>. Then, either the exception is thrown in your code or in
libraries you call. If it is the latter, there should be a third part in
the stack trace with calls made in files under <code class="docutils literal notranslate"><span class="pre">vendor</span></code>. Before
landing in that directory, code goes through numerous review processes
and CI pipelines, which means it should be less likely to be the source
of the issue than code from your application, so it is important that
you focus first on lines starting with <code class="docutils literal notranslate"><span class="pre">src</span></code>, and look for anything
suspicious or unexpected, like method calls that are not supposed to
happen.</p>
<p>Next, you can have a look at what packages are involved. Files under
<code class="docutils literal notranslate"><span class="pre">vendor</span></code> are organized by Composer in the following way:
<code class="docutils literal notranslate"><span class="pre">vendor/acme/router</span></code> where <code class="docutils literal notranslate"><span class="pre">acme</span></code> is the vendor, <code class="docutils literal notranslate"><span class="pre">router</span></code> the
library and <code class="docutils literal notranslate"><span class="pre">acme/router</span></code> the Composer package. If you plan on
reporting the bug, make sure to report it to the library throwing the
exception. <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">home</span> <span class="pre">acme/router</span></code> should lead you to the right
place for that. As Symfony is a monorepository, use <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">home</span>
<span class="pre">symfony/symfony</span></code> when reporting a bug for any component.</p>
</div>
<div class="section" id="getting-stack-traces-with-symfony">
<h2>Getting Stack Traces with Symfony<a class="headerlink" href="#getting-stack-traces-with-symfony" title="Permalink to this headline">¶</a></h2>
<p>Now that we have all this in mind, let us see how to get a stack trace
with Symfony.</p>
<div class="section" id="stack-traces-in-your-web-browser">
<h3>Stack Traces in your Web Browser<a class="headerlink" href="#stack-traces-in-your-web-browser" title="Permalink to this headline">¶</a></h3>
<p>Several things need to be paid attention to when picking a stack trace
from your development environment through a web browser:</p>
<ol class="arabic simple">
<li>Are there several exceptions? If yes, the most interesting one is
often exception 1/n which, is shown <em>last</em> in the example below (it
is the one marked as exception [1/2]).</li>
<li>Under the “Stack Traces” tab, you will find exceptions in plain
text, so that you can easily share them in e.g. bug reports. Make
sure to <strong>remove any sensitive information</strong> before doing so.</li>
<li>You may notice there is a logs tab too; this tab does not have to do
with stack traces, it only contains logs produced in arbitrary places
in your application. They may or may not relate to the exception you
are getting, but are not what the term “stack trace” refers to.</li>
</ol>
<img alt="../../_images/stack-trace.gif" class="with-browser align-center" src="../../_images/stack-trace.gif" />
<p>Since stack traces may contain sensitive data, they should not be
exposed in production. Getting a stack trace from your production
environment, although more involving, is still possible with solutions
that include but are not limited to sending them to an email address
with monolog.</p>
</div>
<div class="section" id="stack-traces-in-the-cli">
<h3>Stack Traces in the CLI<a class="headerlink" href="#stack-traces-in-the-cli" title="Permalink to this headline">¶</a></h3>
<p>Exceptions might occur when running a Symfony command. By default, only
the message is shown because it is often enough to understand what is
going on:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console debug:exception


<span class="go">   Command &quot;debug:exception&quot; is not defined.</span>

<span class="go">   Did you mean one of these?</span>
<span class="go">       debug:autowiring</span>
<span class="go">       debug:config</span>
<span class="go">       debug:container</span>
<span class="go">       debug:event-dispatcher</span>
<span class="go">       debug:form</span>
<span class="go">       debug:router</span>
<span class="go">       debug:translation</span>
<span class="go">       debug:twig</span>
</pre></div>
</td></tr></table></div>
<p>If that is not the case, you can obtain a stack trace by increasing the
<a class="reference internal" href="../../console/verbosity.html"><span class="doc">verbosity level</span></a> with <code class="docutils literal notranslate"><span class="pre">--verbose</span></code>:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> php bin/console --verbose debug:exception

<span class="go"> In Application.php line 644:</span>

<span class="go">   [Symfony\Component\Console\Exception\CommandNotFoundException]</span>
<span class="go">   Command &quot;debug:exception&quot; is not defined.</span>

<span class="go">   Did you mean one of these?</span>
<span class="go">       debug:autowiring</span>
<span class="go">       debug:config</span>
<span class="go">       debug:container</span>
<span class="go">       debug:event-dispatcher</span>
<span class="go">       debug:form</span>
<span class="go">       debug:router</span>
<span class="go">       debug:translation</span>
<span class="go">       debug:twig</span>


<span class="go"> Exception trace:</span>
<span class="go">   at /app/vendor/symfony/console/Application.php:644</span>
<span class="go">  Symfony\Component\Console\Application-&gt;find() at /app/vendor/symfony/framework-bundle/Console/Application.php:116</span>
<span class="go">  Symfony\Bundle\FrameworkBundle\Console\Application-&gt;find() at /app/vendor/symfony/console/Application.php:228</span>
<span class="go">  Symfony\Component\Console\Application-&gt;doRun() at /app/vendor/symfony/framework-bundle/Console/Application.php:82</span>
<span class="go">  Symfony\Bundle\FrameworkBundle\Console\Application-&gt;doRun() at /app/vendor/symfony/console/Application.php:140</span>
<span class="go">  Symfony\Component\Console\Application-&gt;run() at /app/bin/console:42</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="stack-traces-and-api-calls">
<h3>Stack Traces and API Calls<a class="headerlink" href="#stack-traces-and-api-calls" title="Permalink to this headline">¶</a></h3>
<p>When getting an exception from an API, you might not get a stack trace,
or it might be displayed in a way that is not suitable for sharing.
Luckily, when in the dev environment, you can obtain a plain text stack
trace by using the profiler. To find the profile, you can have a look
at the <code class="docutils literal notranslate"><span class="pre">X-Debug-Token-Link</span></code> response headers:</p>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> curl --head http://localhost:8000/api/posts/1
<span class="go">… more headers</span>
<span class="go">X-Debug-Token: 110e1e</span>
<span class="go">X-Debug-Token-Link: http://localhost:8000/_profiler/110e1e</span>
<span class="go">X-Robots-Tag: noindex</span>
<span class="go">X-Previous-Debug-Token: 209101</span>
</pre></div>
</td></tr></table></div>
<p>Following that link will lead you to a page very similar to the one
described above in <a class="reference internal" href="#stack-traces-in-your-web-browser">Stack Traces in your Web Browser</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2004-2020 Fabien Potencier

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>