

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The BrowserKit Component &mdash; Symfony Framework Documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/rtd_custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Cache Component" href="cache.html" />
    <link rel="prev" title="The Asset Component" href="asset.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #f0f0f0" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/symfony-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.2}
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_tour/index.html">The Quick Tour</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../best_practices.html">The Symfony Framework Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bundles.html">The Bundle System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console.html">Console Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doctrine.html">Databases and the Doctrine ORM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">How to Deploy a Symfony Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../email.html">Swift Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_dispatcher.html">Events and Event Listeners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../forms.html">Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontend.html">Managing CSS and JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_cache.html">HTTP Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http_client.html">HTTP Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lock.html">Dealing with Concurrency with Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mailer.html">Sending Emails with Mailer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mercure.html">Pushing Data to Clients Using the Mercure Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../messenger.html">Messenger: Sync &amp; Queued Message Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating an Existing Application to Symfony</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notifier.html">Creating and Sending Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiler.html">Profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rate_limiter.html">Rate Limiter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../session.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Installing &amp; Setting up the Symfony Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serializer.html">How to Use the Serializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_container.html">Service Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../translation.html">Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validation.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_link.html">Asset Preloading and Resource Hints with HTTP/2 and WebLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Workflow</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="using_components.html">How to Install and Use the Symfony Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="asset.html">The Asset Component</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The BrowserKit Component</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage">Basic Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-client">Creating a Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="#making-requests">Making Requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clicking-links">Clicking Links</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submitting-forms">Submitting Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#custom-header-handling">Custom Header Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cookies">Cookies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#retrieving-cookies">Retrieving Cookies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looping-through-cookies">Looping Through Cookies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-cookies">Setting Cookies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#history">History</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-external-http-requests">Making External HTTP Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#learn-more">Learn more</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html">The Cache Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">The Config Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="console.html">The Console Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="contracts.html">The Contracts Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="css_selector.html">The CssSelector Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="dependency_injection.html">The DependencyInjection Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="dom_crawler.html">The DomCrawler Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_dispatcher.html">The EventDispatcher Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="expression_language.html">The ExpressionLanguage Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="filesystem.html">The Filesystem Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="finder.html">The Finder Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="form.html">The Form Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_foundation.html">The HttpFoundation Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_kernel.html">The HttpKernel Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="inflector.html">The Inflector Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="intl.html">The Intl Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldap.html">The Ldap Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="lock.html">The Lock Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="messenger.html">The Messenger Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="mime.html">The Mime Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="options_resolver.html">The OptionsResolver Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="phpunit_bridge.html">The PHPUnit Bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="process.html">The Process Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="property_access.html">The PropertyAccess Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="property_info.html">The PropertyInfo Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="psr7.html">The PSR-7 Bridge</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">The Security Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="semaphore.html">The Semaphore Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="serializer.html">The Serializer Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="string.html">The String Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="uid.html">The UID Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="validator.html">The Validator Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="var_dumper.html">The VarDumper Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="var_exporter.html">The VarExporter Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow.html">The Workflow Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="yaml.html">The Yaml Component</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Documents</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../create_framework/index.html">Create your own PHP Framework</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Symfony Framework Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">The Components</a> &raquo;</li>
        
      <li>The BrowserKit Component</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/components/browser_kit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-browserkit-component">
<span id="index-0"></span><h1>The BrowserKit Component<a class="headerlink" href="#the-browserkit-component" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>The BrowserKit component simulates the behavior of a web browser, allowing
you to make requests, click on links and submit forms programmatically.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Symfony versions prior to 4.3, the BrowserKit component could only make
internal requests to your application. Starting from Symfony 4.3, this
component can also <a class="reference internal" href="#component-browserkit-external-requests"><span class="std std-ref">make HTTP requests to any public site</span></a>
when using it in combination with the <a class="reference internal" href="../http_client.html"><span class="doc">HttpClient component</span></a>.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-terminal notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gp">$</span> composer require symfony/browser-kit
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you install this component outside of a Symfony application, you must
require the <code class="docutils literal notranslate"><span class="pre">vendor/autoload.php</span></code> file in your code to enable the class
autoloading mechanism provided by Composer. Read
<a class="reference internal" href="using_components.html"><span class="doc">this article</span></a> for more details.</p>
</div>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">This article explains how to use the BrowserKit features as an independent
component in any PHP application. Read the <a class="reference internal" href="../testing.html#functional-tests"><span class="std std-ref">Symfony Functional Tests</span></a>
article to learn about how to use it in Symfony applications.</p>
</div>
<div class="section" id="creating-a-client">
<h3>Creating a Client<a class="headerlink" href="#creating-a-client" title="Permalink to this headline">¶</a></h3>
<p>The component only provides an abstract client and does not provide any backend
ready to use for the HTTP layer. To create your own client, you must extend the
<code class="docutils literal notranslate"><span class="pre">AbstractBrowser</span></code> class and implement the
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/AbstractBrowser.php" title="Symfony\Component\BrowserKit\AbstractBrowser::doRequest()"><span class="pre">doRequest()</span></a></code> method.
This method accepts a request and should return a response:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">Acme</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\BrowserKit\AbstractBrowser</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\BrowserKit\Response</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Client</span> <span class="k">extends</span> <span class="nx">AbstractBrowser</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">doRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ... convert request into a response</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="nv">$content</span><span class="p">,</span> <span class="nv">$status</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For a simple implementation of a browser based on the HTTP layer, have a look
at the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/HttpBrowser.php" title="Symfony\Component\BrowserKit\HttpBrowser"><span class="pre">HttpBrowser</span></a></code> provided by
<a class="reference internal" href="#component-browserkit-external-requests"><span class="std std-ref">this component</span></a>. For an implementation based
on <code class="docutils literal notranslate"><span class="pre">HttpKernelInterface</span></code>, have a look at the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/HttpKernel/Client.php" title="Symfony\Component\HttpKernel\Client"><span class="pre">Client</span></a></code>
provided by the <a class="reference internal" href="http_kernel.html"><span class="doc">HttpKernel component</span></a>.</p>
</div>
<div class="section" id="making-requests">
<h3>Making Requests<a class="headerlink" href="#making-requests" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/AbstractBrowser.php" title="Symfony\Component\BrowserKit\AbstractBrowser::request()"><span class="pre">request()</span></a></code> method to
make HTTP requests. The first two arguments are the HTTP method and the requested
URL:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The value returned by the <code class="docutils literal notranslate"><span class="pre">request()</span></code> method is an instance of the
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DomCrawler/Crawler.php" title="Symfony\Component\DomCrawler\Crawler"><span class="pre">Crawler</span></a></code> class, provided by the
<a class="reference internal" href="dom_crawler.html"><span class="doc">DomCrawler component</span></a>, which allows accessing
and traversing HTML elements programmatically.</p>
<p>The <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/AbstractBrowser.php" title="Symfony\Component\BrowserKit\AbstractBrowser::xmlHttpRequest()"><span class="pre">xmlHttpRequest()</span></a></code> method,
which defines the same arguments as the <code class="docutils literal notranslate"><span class="pre">request()</span></code> method, is a shortcut to
make AJAX requests:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="c1">// the required HTTP_X_REQUESTED_WITH header is added automatically</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">xmlHttpRequest</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="clicking-links">
<h3>Clicking Links<a class="headerlink" href="#clicking-links" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AbstractBrowser</span></code> is capable of simulating link clicks. Pass the text
content of the link and the client will perform the needed HTTP GET request to
simulate the link click:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/product/123&#39;</span><span class="p">);</span>

<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">clickLink</span><span class="p">(</span><span class="s1">&#39;Go elsewhere...&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you need the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DomCrawler/Link.php" title="Symfony\Component\DomCrawler\Link"><span class="pre">Link</span></a></code> object that
provides access to the link properties (e.g. <code class="docutils literal notranslate"><span class="pre">$link-&gt;getMethod()</span></code>,
<code class="docutils literal notranslate"><span class="pre">$link-&gt;getUri()</span></code>), use this other method:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/product/123&#39;</span><span class="p">);</span>
<span class="nv">$link</span> <span class="o">=</span> <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">selectLink</span><span class="p">(</span><span class="s1">&#39;Go elsewhere...&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">();</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">click</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="submitting-forms">
<h3>Submitting Forms<a class="headerlink" href="#submitting-forms" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AbstractBrowser</span></code> is also capable of submitting forms. First, select the
form using any of its buttons and then override any of its properties (method,
field values, etc.) before submitting it:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com/login&#39;</span><span class="p">);</span>

<span class="c1">// find the form with the &#39;Log in&#39; button and submit it</span>
<span class="c1">// &#39;Log in&#39; can be the text content, id, value or name of a &lt;button&gt; or &lt;input type=&quot;submit&quot;&gt;</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">submitForm</span><span class="p">(</span><span class="s1">&#39;Log in&#39;</span><span class="p">);</span>

<span class="c1">// the second optional argument lets you override the default form field values</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">submitForm</span><span class="p">(</span><span class="s1">&#39;Log in&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;login&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_user&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_pass&#39;</span><span class="p">,</span>
    <span class="c1">// to upload a file, the value must be the absolute file path</span>
    <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="no">__FILE__</span><span class="p">,</span>
<span class="p">]);</span>

<span class="c1">// you can override other form options too</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">submitForm</span><span class="p">(</span>
    <span class="s1">&#39;Log in&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;login&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_user&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_pass&#39;</span><span class="p">],</span>
    <span class="c1">// override the default form HTTP method</span>
    <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
    <span class="c1">// override some $_SERVER parameters (e.g. HTTP headers)</span>
    <span class="p">[</span><span class="s1">&#39;HTTP_ACCEPT_LANGUAGE&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;es&#39;</span><span class="p">]</span>
<span class="p">);</span>
</pre></div>
</div>
<p>If you need the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DomCrawler/Form.php" title="Symfony\Component\DomCrawler\Form"><span class="pre">Form</span></a></code> object that
provides access to the form properties (e.g. <code class="docutils literal notranslate"><span class="pre">$form-&gt;getUri()</span></code>,
<code class="docutils literal notranslate"><span class="pre">$form-&gt;getValues()</span></code>, <code class="docutils literal notranslate"><span class="pre">$form-&gt;getFields()</span></code>), use this other method:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="c1">// ...</span>

<span class="c1">// select the form and fill in some values</span>
<span class="nv">$form</span> <span class="o">=</span> <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">selectButton</span><span class="p">(</span><span class="s1">&#39;Log in&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">form</span><span class="p">();</span>
<span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;symfonyfan&#39;</span><span class="p">;</span>
<span class="nv">$form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;anypass&#39;</span><span class="p">;</span>

<span class="c1">// submit that form</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">submit</span><span class="p">(</span><span class="nv">$form</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-header-handling">
<h3>Custom Header Handling<a class="headerlink" href="#custom-header-handling" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.2: </span>The <code class="docutils literal notranslate"><span class="pre">getHeaders()</span></code> method was introduced in Symfony 5.2.</p>
</div>
<p>The optional HTTP headers passed to the <code class="docutils literal notranslate"><span class="pre">request()</span></code> method follows the FastCGI
request format (uppercase, underscores instead of dashes and prefixed with <code class="docutils literal notranslate"><span class="pre">HTTP_</span></code>).
Before saving those headers to the request, they are lower-cased, with <code class="docutils literal notranslate"><span class="pre">HTTP_</span></code>
stripped, and underscores turned to dashes.</p>
<p>If you’re making a request to an application that has special rules about header
capitalization or punctuation, override the <code class="docutils literal notranslate"><span class="pre">getHeaders()</span></code> method, which must
return an associative array of headers:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">protected</span> <span class="k">function</span> <span class="nf">getHeaders</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="nv">$headers</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getHeaders</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getServer</span><span class="p">()[</span><span class="s1">&#39;api_key&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$headers</span><span class="p">[</span><span class="s1">&#39;api_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getServer</span><span class="p">()[</span><span class="s1">&#39;api_key&#39;</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$headers</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cookies">
<h2>Cookies<a class="headerlink" href="#cookies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="retrieving-cookies">
<h3>Retrieving Cookies<a class="headerlink" href="#retrieving-cookies" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AbstractBrowser</span></code> implementation exposes cookies (if any) through a
<code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/CookieJar.php" title="Symfony\Component\BrowserKit\CookieJar"><span class="pre">CookieJar</span></a></code>, which allows you to store and
retrieve any cookie while making requests with the client:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="c1">// Make a request</span>
<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// Get the cookie Jar</span>
<span class="nv">$cookieJar</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">getCookieJar</span><span class="p">();</span>

<span class="c1">// Get a cookie by name</span>
<span class="nv">$cookie</span> <span class="o">=</span> <span class="nv">$cookieJar</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;name_of_the_cookie&#39;</span><span class="p">);</span>

<span class="c1">// Get cookie data</span>
<span class="nv">$name</span>       <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getName</span><span class="p">();</span>
<span class="nv">$value</span>      <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getValue</span><span class="p">();</span>
<span class="nv">$rawValue</span>   <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getRawValue</span><span class="p">();</span>
<span class="nv">$isSecure</span>   <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">isSecure</span><span class="p">();</span>
<span class="nv">$isHttpOnly</span> <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">isHttpOnly</span><span class="p">();</span>
<span class="nv">$isExpired</span>  <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">isExpired</span><span class="p">();</span>
<span class="nv">$expires</span>    <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getExpiresTime</span><span class="p">();</span>
<span class="nv">$path</span>       <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getPath</span><span class="p">();</span>
<span class="nv">$domain</span>     <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getDomain</span><span class="p">();</span>
<span class="nv">$sameSite</span>   <span class="o">=</span> <span class="nv">$cookie</span><span class="o">-&gt;</span><span class="na">getSameSite</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These methods only return cookies that have not expired.</p>
</div>
</div>
<div class="section" id="looping-through-cookies">
<h3>Looping Through Cookies<a class="headerlink" href="#looping-through-cookies" title="Permalink to this headline">¶</a></h3>
<div class="highlight-php notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="c1">// Make a request</span>
<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// Get the cookie Jar</span>
<span class="nv">$cookieJar</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">getCookieJar</span><span class="p">();</span>

<span class="c1">// Get array with all cookies</span>
<span class="nv">$cookies</span> <span class="o">=</span> <span class="nv">$cookieJar</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$cookies</span> <span class="k">as</span> <span class="nv">$cookie</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Get all values</span>
<span class="nv">$values</span> <span class="o">=</span> <span class="nv">$cookieJar</span><span class="o">-&gt;</span><span class="na">allValues</span><span class="p">(</span><span class="s1">&#39;http://symfony.com&#39;</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$values</span> <span class="k">as</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// Get all raw values</span>
<span class="nv">$rawValues</span> <span class="o">=</span> <span class="nv">$cookieJar</span><span class="o">-&gt;</span><span class="na">allRawValues</span><span class="p">(</span><span class="s1">&#39;http://symfony.com&#39;</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$rawValues</span> <span class="k">as</span> <span class="nv">$rawValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="setting-cookies">
<h3>Setting Cookies<a class="headerlink" href="#setting-cookies" title="Permalink to this headline">¶</a></h3>
<p>You can also create cookies and add them to a cookie jar that can be injected
into the client constructor:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="c1">// create cookies and add to cookie jar</span>
<span class="nv">$cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cookie</span><span class="p">(</span><span class="s1">&#39;flavor&#39;</span><span class="p">,</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">&#39;+1 day&#39;</span><span class="p">));</span>
<span class="nv">$cookieJar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CookieJar</span><span class="p">();</span>
<span class="nv">$cookieJar</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$cookie</span><span class="p">);</span>

<span class="c1">// create a client and set the cookies</span>
<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">([],</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$cookieJar</span><span class="p">);</span>
<span class="c1">// ...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<p>The client stores all your requests allowing you to go back and forward in your
history:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// select and click on a link</span>
<span class="nv">$link</span> <span class="o">=</span> <span class="nv">$crawler</span><span class="o">-&gt;</span><span class="na">selectLink</span><span class="p">(</span><span class="s1">&#39;Documentation&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">();</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">click</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>

<span class="c1">// go back to home page</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">back</span><span class="p">();</span>

<span class="c1">// go forward to documentation page</span>
<span class="nv">$crawler</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">forward</span><span class="p">();</span>
</pre></div>
</div>
<p>You can delete the client’s history with the <code class="docutils literal notranslate"><span class="pre">restart()</span></code> method. This will
also delete all the cookies:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Acme\Client</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// reset the client (history and cookies are cleared too)</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="na">restart</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="making-external-http-requests">
<span id="component-browserkit-external-requests"></span><h2>Making External HTTP Requests<a class="headerlink" href="#making-external-http-requests" title="Permalink to this headline">¶</a></h2>
<p>So far, all the examples in this article have assumed that you are making
internal requests to your own application. However, you can run the exact same
examples when making HTTP requests to external web sites and applications.</p>
<p>First, install and configure the <a class="reference internal" href="../http_client.html"><span class="doc">HttpClient component</span></a>.
Then, use the <code class="docutils literal notranslate"><a class="reference external" href="https://github.com/symfony/symfony/blob/master/src/Symfony/Component/BrowserKit/HttpBrowser.php" title="Symfony\Component\BrowserKit\HttpBrowser"><span class="pre">HttpBrowser</span></a></code> to create
the client that will make the external HTTP requests:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Symfony\Component\BrowserKit\HttpBrowser</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpClient\HttpClient</span><span class="p">;</span>

<span class="nv">$browser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HttpBrowser</span><span class="p">(</span><span class="nx">HttpClient</span><span class="o">::</span><span class="na">create</span><span class="p">());</span>
</pre></div>
</div>
<p>You can now use any of the methods shown in this article to extract information,
click links, submit forms, etc. This means that you no longer need to use a
dedicated web crawler or scraper such as <a class="reference external" href="https://github.com/FriendsOfPHP/Goutte">Goutte</a>:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="nv">$browser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HttpBrowser</span><span class="p">(</span><span class="nx">HttpClient</span><span class="o">::</span><span class="na">create</span><span class="p">());</span>

<span class="nv">$browser</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;https://github.com&#39;</span><span class="p">);</span>
<span class="nv">$browser</span><span class="o">-&gt;</span><span class="na">clickLink</span><span class="p">(</span><span class="s1">&#39;Sign in&#39;</span><span class="p">);</span>
<span class="nv">$browser</span><span class="o">-&gt;</span><span class="na">submitForm</span><span class="p">(</span><span class="s1">&#39;Sign in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;login&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;...&#39;</span><span class="p">]);</span>
<span class="nv">$openPullRequests</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$browser</span><span class="o">-&gt;</span><span class="na">clickLink</span><span class="p">(</span><span class="s1">&#39;Pull requests&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">filter</span><span class="p">(</span>
    <span class="s1">&#39;.table-list-header-toggle a:nth-child(1)&#39;</span>
<span class="p">)</span><span class="o">-&gt;</span><span class="na">text</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="learn-more">
<h2>Learn more<a class="headerlink" href="#learn-more" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../testing.html"><span class="doc">Testing</span></a></li>
<li><a class="reference internal" href="css_selector.html"><span class="doc">The CssSelector Component</span></a></li>
<li><a class="reference internal" href="dom_crawler.html"><span class="doc">The DomCrawler Component</span></a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2004-2020 Fabien Potencier

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>